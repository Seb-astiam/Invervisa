<div class="products-container">
    <header class="products-header">
        <div class="header-content">
            <h1 class="page-title">Todos los Productos</h1>
            <p class="page-subtitle">Explora nuestra colección completa de productos</p>
        </div>
        
        <div class="header-actions">
            <div class="search-container">
                <input 
                    type="text" 
                    placeholder="Buscar productos..." 
                    class="search-input"
                    [(ngModel)]="searchTerm"
                    (input)="onSearch()"
                />
                <svg class="search-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="11" cy="11" r="8"/>
                    <path d="M21 21l-4.35-4.35"/>
                </svg>
            </div>
            
            <div class="view-options">
                <button 
                    class="view-btn" 
                    [class.active]="viewMode === 'grid'"
                    (click)="setViewMode('grid')"
                    title="Vista de cuadrícula"
                >
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <rect x="3" y="3" width="7" height="7"/>
                        <rect x="14" y="3" width="7" height="7"/>
                        <rect x="14" y="14" width="7" height="7"/>
                        <rect x="3" y="14" width="7" height="7"/>
                    </svg>
                </button>
                <button 
                    class="view-btn" 
                    [class.active]="viewMode === 'list'"
                    (click)="setViewMode('list')"
                    title="Vista de lista"
                >
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="8" y1="6" x2="21" y2="6"/>
                        <line x1="8" y1="12" x2="21" y2="12"/>
                        <line x1="8" y1="18" x2="21" y2="18"/>
                        <line x1="3" y1="6" x2="3.01" y2="6"/>
                        <line x1="3" y1="12" x2="3.01" y2="12"/>
                        <line x1="3" y1="18" x2="3.01" y2="18"/>
                    </svg>
                </button>
            </div>
        </div>
    </header>

    @if (loading) {
    <div class="loading-container">
        <div class="loading-spinner"></div>
        <p>Cargando productos...</p>
    </div>
    }

    @if (!loading && products.length === 0) {
    <div class="empty-state">
        <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1">
            <rect x="3" y="3" width="18" height="18" rx="2" ry="2"/>
            <path d="M9 9h.01M15 9h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
        </svg>
        <h3>No se encontraron productos</h3>
        <p>Intenta ajustar los filtros de búsqueda o explorar otras categorías.</p>
    </div>
    }

    @if (!loading && products.length > 0) {
    <div class="products-stats">
        <span class="results-count">{{ filteredProducts.length }} productos encontrados</span>
        @if (searchTerm) {
        <span class="search-term">para "{{ searchTerm }}"</span>
        }
    </div>

    <div class="products-grid" [class.list-view]="viewMode === 'list'">
        @for (product of paginatedProducts; track product.id) {
        <article class="product-card" [class.list-layout]="viewMode === 'list'">
            <div class="product-image-section">
                @if (product.imageUrl) {
                <img [src]="product.imageUrl" [alt]="product.name" class="product-image"/>
                } @else {
                <div class="image-placeholder">
                    <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1">
                        <rect x="3" y="3" width="18" height="18" rx="2" ry="2"/>
                        <circle cx="8.5" cy="8.5" r="1.5"/>
                        <path d="M21 15l-5-5L5 21"/>
                    </svg>
                </div>
                }
                
                @if (product.discount > 0) {
                <div class="discount-badge">-{{ product.discount }}%</div>
                }
            </div>

            <div class="product-content">
                <div class="product-header">
                    @if (product.brand) {
                    <span class="brand-tag">{{ product.brand }}</span>
                    }
                    <h3 class="product-title">
                        <a [routerLink]="['/productos', product.id]">{{ product.name }}</a>
                    </h3>
                    @if (product.description) {
                    <p class="product-description">{{ product.description }}</p>
                    }
                </div>

                <div class="product-pricing">
                    @if (product.discount > 0) {
                    <div class="price-container">
                        <span class="current-price">${{ getDiscountedPrice(product.price, product.discount) }}</span>
                        <span class="original-price">${{ product.price }}</span>
                    </div>
                    } @else {
                    <span class="current-price">${{ product.price }}</span>
                    }
                </div>

                <div class="product-actions">
                    <button (click)="addToCart(product)" class="add-to-cart-btn">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M9 22a1 1 0 1 0 0-2 1 1 0 0 0 0 2z"/>
                            <path d="M20 22a1 1 0 1 0 0-2 1 1 0 0 0 0 2z"/>
                            <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"/>
                        </svg>
                        Agregar al carrito
                    </button>
                    
                    <a [routerLink]="['/productos', product.id]" class="view-details-btn">
                        Ver detalles
                    </a>
                </div>
            </div>
        </article>
        }
    </div>

    @if (filteredProducts.length > 0) {
    <div class="pagination">
        <button 
            class="pagination-btn" 
            [disabled]="currentPage === 1"
            (click)="previousPage()"
        >
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M15 18l-6-6 6-6"/>
            </svg>
            Anterior
        </button>
        
        <div class="page-numbers">
            @for (page of getPageNumbers(); track page) {
            <button 
                class="page-number" 
                [class.active]="page === currentPage"
                (click)="goToPage(page)"
            >
                {{ page }}
            </button>
            }
        </div>
        
        <button 
            class="pagination-btn" 
            [disabled]="currentPage === totalPages"
            (click)="nextPage()"
        >
            Siguiente
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M9 18l6-6-6-6"/>
            </svg>
        </button>
    </div>
    }
    }
</div>
